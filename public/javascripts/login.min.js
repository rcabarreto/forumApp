$(document).ready(function(){loadProfile()});$("#loginForm").on("submit",function(e){e.preventDefault();var myForm=$(this);var formData=myForm.serializeFormJSON();var googleUrl="http://picasaweb.google.com/data/entry/api/user/"+formData.email+"?alt=json";$.getJSON(googleUrl).done(function(data){console.log(data.entry.gphoto$nickname.$t);console.log(data.entry.gphoto$thumbnail.$t)}).fail(function(){console.log("Erro!")});$.ajax({url:"/api/login",type:"POST",data:formData,success:function(data){$(location).attr("href","/")},error:function(err){var errorJson=err.responseJSON;$("#loginCard").prepend(""+'<div class="alert alert-danger alert-dismissible" role="alert">'+'<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>'+"<strong>"+errorJson.title+"</strong> "+errorJson.message+"</div>")}})});function getLocalProfile(callback){var profileImgSrc=localStorage.getItem("PROFILE_IMG_SRC");var profileName=localStorage.getItem("PROFILE_NAME");var profileReAuthEmail=localStorage.getItem("PROFILE_REAUTH_EMAIL");if(profileName!==null&&profileReAuthEmail!==null&&profileImgSrc!==null){callback(profileImgSrc,profileName,profileReAuthEmail)}}function loadProfile(){if(!supportsHTML5Storage()){return false}getLocalProfile(function(profileImgSrc,profileName,profileReAuthEmail){$("#profile-img").attr("src",profileImgSrc);$("#profile-name").html(profileName);$("#reauth-email").html(profileReAuthEmail);$("#inputEmail").hide().val(profileReAuthEmail);$("#remember").hide()})}function supportsHTML5Storage(){try{return"localStorage"in window&&window["localStorage"]!==null}catch(e){return false}}function setLocalStorageData(username,email,thumbnail){if(!supportsHTML5Storage()){return false}localStorage.setItem("PROFILE_NAME",username);localStorage.setItem("PROFILE_REAUTH_EMAIL",email);localStorage.setItem("PROFILE_IMG_SRC",thumbnail)}function clearLocalStorage(){localStorage.removeItem("PROFILE_IMG_SRC");localStorage.removeItem("PROFILE_NAME");localStorage.removeItem("PROFILE_REAUTH_EMAIL")}